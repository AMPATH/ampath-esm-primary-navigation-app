(self.webpackChunk_openmrs_esm_app_shell=self.webpackChunk_openmrs_esm_app_shell||[]).push([[269],{269:(e,t,n)=>{"use strict";n.r(t),n.d(t,{run:()=>D});var r=n(48881),o=n(14357),i=n(52604),a=n.n(i),s=n(69856),c=n(94728),l=n(29256);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function p(e,t,n){if("function"!=typeof e.importTranslation)throw Error("Module ".concat(t," does not export an importTranslation function"));if(!n)return Promise.resolve({});n.includes("-")&&(n=n.replace("-","_"));var r,o,i=e.importTranslation("./".concat(n,".json"));if(r=i,!(null!=(o=Promise)&&"undefined"!=typeof Symbol&&o[Symbol.hasInstance]?o[Symbol.hasInstance](r):r instanceof o))throw Error("Module ".concat(t," exports an importTranslation function that does not return a promise. Did you forget to set require.context mode to 'lazy'?"));return i}function m(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}(0,o.registerTranslationNamespace)("core");var h=!1;(0,o.subscribeOpenmrsEvent)("started",(function(){return h=!0})),window.addEventListener("single-spa:before-routing-event",(function(e){if(h&&function(e){return"detail"in e&&"object"===m(e.detail)&&null!==e.detail&&"appsByNewStatus"in e.detail&&"object"===m(e.detail.appsByNewStatus)&&null!==e.detail.appsByNewStatus&&"cancelNavigation"in e.detail&&"function"==typeof e.detail.cancelNavigation}(e)&&e.detail.totalAppChanges>0){var t=e.detail.appsByNewStatus.MOUNTED.find((function(e){return!e.startsWith("@openmrs/esm-primary-navigation-app")&&!e.startsWith("@openmrs/esm-devtools-app")&&!e.startsWith("@openmrs/esm-help-menu-app")})),n={cancelNavigation:e.detail.cancelNavigation,newPage:void 0,oldUrl:e.detail.oldUrl,newUrl:e.detail.newUrl};t&&(n.newPage=t),(0,o.fireOpenmrsEvent)("before-page-changed",n)}}));var v=n(98790);(0,o.subscribeOpenmrsEvent)("started",(function(){return(0,o.cleanupObsoleteFeatureFlags)()})),(0,o.subscribeOpenmrsEvent)("started",(function(){var e=(0,o.getCurrentUser)().subscribe((function(t){var n;t.authenticated&&(null==e||e.unsubscribe(),(n=window.installedModules.reduce((function(e,t){var n;return(null===(n=t[1])||void 0===n?void 0:n.optionalBackendDependencies)&&Object.entries(t[1].optionalBackendDependencies).forEach((function(n){var r,o,i,a,s=n[1];"string"!=typeof s&&("object"==((a=s.feature)&&"undefined"!=typeof Symbol&&a.constructor===Symbol?"symbol":typeof a)&&s.feature&&(null===(r=s.feature.flagName)||void 0===r?void 0:r.length)>0&&(null===(o=s.feature.label)||void 0===o?void 0:o.length)>0&&(null===(i=s.feature.description)||void 0===i?void 0:i.length)>0?e.set(n[0],{version:s.version,feature:s.feature}):console.warn("Feature flag descriptor for ".concat(t[0]," does not match expected type. Feature flags must define a 'flagName', 'label', and 'description'")))})),e}),new Map)).size>0&&(0,o.openmrsFetch)("".concat(o.restBaseUrl,"/module?v=custom:(uuid,version)")).then((function(e){var t;(null!==(t=e.data.results)&&void 0!==t?t:[]).forEach((function(e){if(n.has(e.uuid)){var t=n.get(e.uuid);t&&(0,v.satisfies)(e.version,t.version,{includePrerelease:!0})&&((0,o.registerFeatureFlag)(t.feature.flagName,t.feature.label,t.feature.description),(0,o.setFeatureFlag)(t.feature.flagName,!0))}}))})).catch((function(){})))}))}));var b=n(71432),y="@openmrs/esm-app-shell";function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){g(e,t,n[t])}))}return e}function S(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function P(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){O(i,r,o,a,s,"next",e)}function s(e){O(i,r,o,a,s,"throw",e)}a(void 0)}))}}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var E=Symbol("openmrs_registration_promises");function N(){return P((function(){var e,t,n,r,i,a,s,c,l;return A(this,(function(u){switch(u.label){case 0:for(e=document.querySelectorAll("script[type='openmrs-routes']"),t=[],n=0;n<e.length;n++)t.push(function(e){return P((function(){var t,n,r;return A(this,(function(i){switch(i.label){case 0:t=void 0,i.label=1;case 1:return i.trys.push([1,5,,6]),e.textContent?(t=JSON.parse(e.textContent),[3,4]):[3,2];case 2:return e.src?[4,(0,o.openmrsFetch)(e.src)]:[3,4];case 3:t=i.sent().data,i.label=4;case 4:return[3,6];case 5:return n=i.sent(),console.error("Caught error while loading routes from ".concat(null!==(r=e.src)&&void 0!==r?r:"JSON script tag content"),n),[2,{}];case 6:return[2,Promise.resolve(null!=t?t:{})]}}))}))()}(e.item(n)));if((0,o.canAccessStorage)())for(r=function(e){var n=i.key(e);if(null==n?void 0:n.startsWith(o.localStorageRoutesPrefix)){var r=i.getItem(n);if(r)try{var a=JSON.parse(r);(0,o.isOpenmrsAppRoutes)(a)?t.push(Promise.resolve(k({},n.slice(o.localStorageRoutesPrefix.length),a))):"string"==typeof a&&a.startsWith("http")?t.push((0,o.openmrsFetch)(a).then((function(e){return(0,o.isOpenmrsAppRoutes)(e.data)?Promise.resolve(k({},n.slice(o.localStorageRoutesPrefix.length),e.data)):Promise.reject("".concat(a," did not resolve to a valid OpenmrsAppRoutes JSON object"))})).catch((function(e){throw console.warn("Failed to fetch route overrides for ".concat(n.slice(o.localStorageRoutesPrefix.length)),e),e}))):console.warn("Route override for ".concat(n.slice(o.localStorageRoutesPrefix.length)," could not be handled as it was neither a JSON object nor a URL string"),r)}catch(e){console.error("Error parsing local route override for ".concat(n),e)}}},i=window.localStorage,a=0;a<i.length;a++)r(a);return[4,Promise.allSettled(t)];case 1:return s=u.sent().filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})).filter(o.isOpenmrsRoutes).reduce((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){k(e,t,n[t])}))}return e}({},e,t)}),{}),c=[],l=Object.entries(s).map((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),n=t[0],r=t[1];return P((function(){return A(this,(function(e){return c.push([n,r]),(0,o.registerApp)(n,r),[2]}))}))()})),window[E]=Promise.all(l),window.installedModules=c,[2]}}))}))()}function _(e){return P((function(){var t,n,r,i,a,s;return A(this,(function(c){t=!0,n=!1,r=void 0;try{for(i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0)s=a.value,(0,o.provide)(s.value,s.name)}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return[2]}))}))()}function C(){if(window.offlineEnabled){var e=navigator.onLine;(0,r.triggerAppChange)(),(0,o.dispatchConnectivityChanged)(e),(0,o.showToast)({critical:!0,description:"Connection: ".concat(e?"online":"offline"),title:"App",kind:e?"success":"warning"})}}function x(){return P((function(){return A(this,(function(e){return[2,(t=window.i18next=a()||i,new MutationObserver((function(){t.changeLanguage().catch((function(e){return console.error("i18next failed to re-detect language",e)}))})).observe(document.documentElement,{attributeFilter:["lang"],attributes:!0}),t.on("languageChanged",(function(){document.documentElement.setAttribute("dir",t.dir())})),t.use(s.A).use({type:"backend",init:function(){},read:function(e,t,r){if("translation"===t)r(Error("can't handle translation namespace"),null);else if(void 0===t||void 0===e)r(Error(),null);else if("core"===t)Promise.all([n(61343)("./".concat(e,".json")),(0,o.getTranslationOverrides)(t)]).then((function(t){var n,o=f(t,2),i=o[0],a=f(o[1],1)[0],s=null!==(n=null==i?void 0:i.default)&&void 0!==n?n:{};e in a&&(s=(0,l.A)(s,a[e])),r(null,s)})).catch((function(e){r(e,null)}));else{var i=f(t.split("___"),3),a=i[0],s=i[1],c=i[2];(0,o.importDynamic)(a).then((function(t){return Promise.all([p(t,a,e),(0,o.getTranslationOverrides)(a,s,c)])})).then((function(t){var n,o=f(t,2),i=o[0],p=o[1],m=null!=i?i:{};s&&c&&(p.length>=1&&e in p[0]?window.i18next.addResourceBundle(e,a,(0,l.A)(m,p[0][e]),!0,!1):window.i18next.addResourceBundle(e,a,m,!0,!1)),m=l.A.apply(void 0,[m].concat(function(e){if(Array.isArray(e))return u(e)}(n=p.filter((function(t){return e in t})).map((function(t){return t[e]})))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||d(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),r(null,m)})).catch((function(e){r(e,null)}))}}}).use(c.initReactI18next).init({detection:{order:["querystring","htmlTag","localStorage","navigator"],lookupQuerystring:"lang"},fallbackLng:"en",nsSeparator:!1})).catch((function(e){return console.error("Failed to initialize translations",e)})).then((function(){return P((function(){var e,t,n,r,i,a,s;return A(this,(function(c){switch(c.label){case 0:return[4,(0,o.getConfig)("@openmrs/esm-styleguide")];case 1:e=c.sent().preferredCalendar,t=!0,n=!1,r=void 0;try{for(i=Object.entries(e)[Symbol.iterator]();!(t=(a=i.next()).done);t=!0)s=a.value,(0,o.registerDefaultCalendar)(s[0],s[1])}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return[2]}}))}))()})).then((function(){return(0,r.start)()}))];var t}))}))()}function T(e){console.error(e),function(e){var t=document.querySelector("#app-error");if(t){var n=t.content.cloneNode(!0),r=n.querySelector('[data-var="message"]');if(r&&(r.textContent=(null==e?void 0:e.message)||"No additional information available."),localStorage.getItem("openmrs:devtools")&&Object.keys(localStorage).some((function(e){return e.startsWith("import-map-override:")}))){var o=null==n?void 0:n.querySelector("#buttons");if(o){var i=document.createElement("button");i.className="cds--btn",i.innerHTML="Clear dev overrides",i.onclick=R,o.appendChild(i)}}document.body.appendChild(n)}}(e)}function R(){Object.keys(localStorage).filter((function(e){return e.startsWith("import-map-override:")&&!["import-map-override:react","import-map-override:react-dom"].includes(e)})).forEach((function(e){return localStorage.removeItem(e)})),location.reload()}function F(){return P((function(){var e;return A(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,(0,o.registerOmrsServiceWorker)("".concat(window.getOpenmrsSpaBase(),"service-worker.js"))];case 1:return t.sent(),[4,(0,o.activateOfflineCapability)()];case 2:return t.sent(),n=null,r=function(e,t){var r=!n||(new Date).getTime()-n.getTime()>3e5;t&&e&&r&&(n=new Date,(0,o.dispatchPrecacheStaticDependencies)())},i=!1,a=!1,(0,o.getCurrentUser)({includeAuthStatus:!1}).subscribe((function(e){r(i,a=!!e)})),(0,o.subscribeConnectivity)((function(e){var t=e.online;i=t,r(t,a)})),[3,4];case 3:return e=t.sent(),console.error("Error while setting up offline mode.",e),(0,o.showNotification)({kind:"error",title:"Offline Setup Error",description:e.message}),[3,4];case 4:return[2]}var n,r,i,a}))}))()}function M(){return P((function(){var e;return A(this,(function(t){switch(t.label){case 0:return[4,P((function(){var e;return A(this,(function(t){switch(t.label){case 0:return[4,window.importMapOverrides.getCurrentPageMap()];case 1:return e=t.sent(),[4,(0,o.messageOmrsServiceWorker)({type:"onImportMapChanged",importMap:e})];case 2:return t.sent(),[2]}}))}))()];case 1:return t.sent(),e=new URL("".concat(window.openmrsBase).concat(o.restBaseUrl,"/session"),window.location.origin).href,[4,(0,o.messageOmrsServiceWorker)({type:"registerDynamicRoute",url:e,strategy:"network-first"})];case 2:return t.sent(),[4,(0,o.openmrsFetch)("".concat(o.restBaseUrl,"/session")).catch((function(e){return console.warn("Failed to precache the user session data from the app shell. MFs depending on this data may run into problems while offline.",e)}))];case 3:return t.sent(),[2]}}))}))()}function U(){window.addEventListener("offline",C),window.addEventListener("online",C)}function I(){(0,o.subscribeConnectivity)((function(e){var t=e.online,n=document.querySelector("body");t?n.classList.remove("omrs-offline"):n.classList.add("omrs-offline")}))}function D(e){var t=window.offlineEnabled,r=(0,o.renderLoadingSpinner)(document.body),i=function(e){var t=Promise.all(e.map((function(e){var t=(0,o.interpolateUrl)(e);return fetch(t).then((function(e){return e.json()})).then((function(t){return{name:e,value:t}})).catch((function(t){return console.error('Loading the config from "'.concat(e,'" failed.'),t),{name:e,value:{}}}))})));return function(){return t.then(_)}}(e);return Promise.all([n.e(2594),n.e(796),n.e(1420),n.e(5315),n.e(8636),n.e(9197)]).then(n.bind(n,39197)).then((function(){return(0,o.integrateBreakpoints)(),(0,o.renderToasts)(document.querySelector(".omrs-toasts-container")),(0,o.setupModals)(document.querySelector(".omrs-modals-container")),(0,o.renderInlineNotifications)(document.querySelector(".omrs-inline-notifications-container")),(0,o.renderActionableNotifications)(document.querySelector(".omrs-actionable-notifications-container")),(0,o.renderSnackbars)(document.querySelector(".omrs-snackbars-container")),(0,o.renderWorkspaceWindowsAndMenu)(document.querySelector("#omrs-workspaces-container")),(0,o.subscribeNotificationShown)(o.showNotification),(0,o.subscribeActionableNotificationShown)(o.showActionableNotification),(0,o.subscribeToastShown)(o.showToast),(0,o.subscribeSnackbarShown)(o.showSnackbar),(0,o.subscribePrecacheStaticDependencies)(M),(0,o.setupApiModule)(),(0,o.setupHistory)(),function(){var e,t=(e={featureName:"app-shell",moduleName:y},[{name:"breadcrumbs-widget",slot:"breadcrumbs-slot",load:(0,b.getAsyncLifecycle)((function(){return Promise.all([n.e(796),n.e(5315),n.e(1114)]).then(n.bind(n,71114))}),e),online:!0,offline:!0}]),r=!0,i=!1,a=void 0;try{for(var s,c=t[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;(0,o.tryRegisterExtension)(y,l)}}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}}(),(0,b.defineConfigSchema)(y,{"Enabled feature flags":{_description:"The feature flags that will be enabled",_type:b.Type.Array,_default:[],_elements:{_type:b.Type.String}}}),(0,o.registerModuleLoad)(y),(0,b.getConfigStore)(y).subscribe((function(e){var t=e.config,n=new Set((null==t?void 0:t["Enabled feature flags"])||[]);if(n.size){var r=w({},o.featureFlagsStore.getState().flags),i=!0,a=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var u=c.value;r[u]?r[u]=S(w({},r[u]),{enabled:!0}):console.error('Feature flag "'.concat(u,'" does not exist. Please define the flag first.'))}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}o.featureFlagsStore.setState({flags:r})}})),N().then(o.finishRegisteringAllApps).then(t?I:void 0).then(t?U:void 0).then(i).then(x).catch(T).then(r).then(t?F:void 0).then((function(){(0,o.fireOpenmrsEvent)("started")}))}))}},61343:(e,t,n)=>{var r={"./am.json":[24468,4468],"./ar.json":[80685,685],"./ar_SY.json":[13066,3066],"./bn.json":[9294,9294],"./cs.json":[43576,3576],"./de.json":[49161,9161],"./en.json":[97581,7581],"./en_US.json":[94734,4734],"./es.json":[19238,9238],"./es_MX.json":[74254,4254],"./fr.json":[1502,1502],"./he.json":[8437,8437],"./hi.json":[55433,5433],"./hi_IN.json":[80405,405],"./id.json":[49207,9207],"./it.json":[4103,4103],"./ka.json":[13698,3698],"./km.json":[62614,2614],"./ku.json":[29934,9934],"./ky.json":[29258,9258],"./lg.json":[65367,5367],"./ne.json":[53291,3291],"./pl.json":[6218,6218],"./pt.json":[93666,3666],"./pt_BR.json":[81787,1787],"./qu.json":[46908,6908],"./ro_RO.json":[80133,133],"./ru_RU.json":[66117,6117],"./si.json":[16626,6626],"./sq.json":[99258,6877],"./sw.json":[62692,2692],"./sw_KE.json":[79845,9845],"./tr.json":[75104,5104],"./tr_TR.json":[22227,2227],"./uk.json":[92462,2462],"./uz.json":[78777,8777],"./uz@Latn.json":[41074,1074],"./uz_UZ.json":[12533,2533],"./vi.json":[94647,4647],"./zh.json":[53224,3224],"./zh_CN.json":[59908,9908],"./zh_TW.json":[69652,9652]};function o(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((()=>n.t(o,19)))}o.keys=()=>Object.keys(r),o.id=61343,e.exports=o}}]);