"use strict";(globalThis.webpackChunk_openmrs_esm_login_app=globalThis.webpackChunk_openmrs_esm_login_app||[]).push([["5729"],{12666:function(e,t,r){r.r(t),r.d(t,{default:()=>E,infinite:()=>f,unstable_serialize:()=>o});var i=r(4449),n=r(21374),a=r(23097);let l=i.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;if("rejected"===e.status)throw e.reason;throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e}),s={dedupe:!0};a.OBJECT.defineProperty(a.SWRConfig,"defaultValue",{value:a.defaultConfig});let u=(0,a.withArgs)((e,t,r)=>{let{cache:u,compare:d,suspense:o,fallbackData:c,revalidateOnMount:f,revalidateIfStale:E,refreshInterval:g,refreshWhenHidden:_,refreshWhenOffline:p,keepPreviousData:h}=r,[U,R,C,b]=a.SWRGlobalState.get(u),[m,v]=(0,a.serialize)(e),I=(0,i.useRef)(!1),T=(0,i.useRef)(!1),V=(0,i.useRef)(m),N=(0,i.useRef)(t),L=(0,i.useRef)(r),S=()=>L.current,k=()=>S().isVisible()&&S().isOnline(),[y,w,F,D]=(0,a.createCacheHelper)(u,m),O=(0,i.useRef)({}).current,A=(0,a.isUndefined)(c)?r.fallback[m]:c,P=(e,t)=>{for(let r in O)if("data"===r){if(!d(e[r],t[r])&&(!(0,a.isUndefined)(e[r])||!d(Y,t[r])))return!1}else if(t[r]!==e[r])return!1;return!0},H=(0,i.useMemo)(()=>{let e=!!m&&!!t&&((0,a.isUndefined)(f)?!S().isPaused()&&!o&&(!!(0,a.isUndefined)(E)||E):f),r=t=>{let r=(0,a.mergeObjects)(t);return(delete r._k,e)?{isValidating:!0,isLoading:!0,...r}:r},i=y(),n=D(),l=r(i),s=i===n?l:r(n),u=l;return[()=>{let e=r(y());return P(e,u)?(u.data=e.data,u.isLoading=e.isLoading,u.isValidating=e.isValidating,u.error=e.error,u):(u=e,e)},()=>s]},[u,m]),z=(0,n.useSyncExternalStore)((0,i.useCallback)(e=>F(m,(t,r)=>{P(r,t)||e()}),[u,m]),H[0],H[1]),G=!I.current,M=U[m]&&U[m].length>0,j=z.data,W=(0,a.isUndefined)(j)?A:j,x=z.error,X=(0,i.useRef)(W),Y=h?(0,a.isUndefined)(j)?X.current:j:W,q=(!M||!!(0,a.isUndefined)(x))&&(G&&!(0,a.isUndefined)(f)?f:!S().isPaused()&&(o?!(0,a.isUndefined)(W)&&E:(0,a.isUndefined)(W)||E)),B=!!(m&&t&&G&&q),J=(0,a.isUndefined)(z.isValidating)?B:z.isValidating,K=(0,a.isUndefined)(z.isLoading)?B:z.isLoading,Q=(0,i.useCallback)(async e=>{let t,i,n=N.current;if(!m||!n||T.current||S().isPaused())return!1;let l=!0,s=e||{},u=!C[m]||!s.dedupe,o=()=>a.IS_REACT_LEGACY?!T.current&&m===V.current&&I.current:m===V.current,c={isValidating:!1,isLoading:!1},f=()=>{w(c)},E=()=>{let e=C[m];e&&e[1]===i&&delete C[m]},g={isValidating:!0};(0,a.isUndefined)(y().data)&&(g.isLoading=!0);try{if(u&&(w(g),r.loadingTimeout&&(0,a.isUndefined)(y().data)&&setTimeout(()=>{l&&o()&&S().onLoadingSlow(m,r)},r.loadingTimeout),C[m]=[n(v),(0,a.getTimestamp)()]),[t,i]=C[m],t=await t,u&&setTimeout(E,r.dedupingInterval),!C[m]||C[m][1]!==i)return u&&o()&&S().onDiscarded(m),!1;c.error=a.UNDEFINED;let e=R[m];if(!(0,a.isUndefined)(e)&&(i<=e[0]||i<=e[1]||0===e[1]))return f(),u&&o()&&S().onDiscarded(m),!1;let s=y().data;c.data=d(s,t)?s:t,u&&o()&&S().onSuccess(t,m,r)}catch(r){E();let e=S(),{shouldRetryOnError:t}=e;!e.isPaused()&&(c.error=r,u&&o()&&(e.onError(r,m,e),(!0===t||(0,a.isFunction)(t)&&t(r))&&(!S().revalidateOnFocus||!S().revalidateOnReconnect||k())&&e.onErrorRetry(r,m,e,e=>{let t=U[m];t&&t[0]&&t[0](a.revalidateEvents.ERROR_REVALIDATE_EVENT,e)},{retryCount:(s.retryCount||0)+1,dedupe:!0})))}return l=!1,f(),!0},[m,u]),Z=(0,i.useCallback)((...e)=>(0,a.internalMutate)(u,V.current,...e),[]);if((0,a.useIsomorphicLayoutEffect)(()=>{N.current=t,L.current=r,(0,a.isUndefined)(j)||(X.current=j)}),(0,a.useIsomorphicLayoutEffect)(()=>{if(!m)return;let e=Q.bind(a.UNDEFINED,s),t=0,r=(0,a.subscribeCallback)(m,U,(r,i={})=>{if(r==a.revalidateEvents.FOCUS_EVENT){let r=Date.now();S().revalidateOnFocus&&r>t&&k()&&(t=r+S().focusThrottleInterval,e())}else if(r==a.revalidateEvents.RECONNECT_EVENT)S().revalidateOnReconnect&&k()&&e();else if(r==a.revalidateEvents.MUTATE_EVENT)return Q();else if(r==a.revalidateEvents.ERROR_REVALIDATE_EVENT)return Q(i)});return T.current=!1,V.current=m,I.current=!0,w({_k:v}),q&&((0,a.isUndefined)(W)||a.IS_SERVER?e():(0,a.rAF)(e)),()=>{T.current=!0,r()}},[m]),(0,a.useIsomorphicLayoutEffect)(()=>{let e;function t(){let t=(0,a.isFunction)(g)?g(y().data):g;t&&-1!==e&&(e=setTimeout(r,t))}function r(){!y().error&&(_||S().isVisible())&&(p||S().isOnline())?Q(s).then(t):t()}return t(),()=>{e&&(clearTimeout(e),e=-1)}},[g,_,p,m]),(0,i.useDebugValue)(Y),o&&(0,a.isUndefined)(W)&&m){if(!a.IS_REACT_LEGACY&&a.IS_SERVER)throw Error("Fallback data is required when using suspense in SSR.");N.current=t,L.current=r,T.current=!1;let e=b[m];if((0,a.isUndefined)(e)||l(Z(e)),(0,a.isUndefined)(x)){let e=Q(s);(0,a.isUndefined)(Y)||(e.status="fulfilled",e.value=!0),l(e)}else throw x}return{mutate:Z,get data(){return O.data=!0,Y},get error(){return O.error=!0,x},get isValidating(){return O.isValidating=!0,J},get isLoading(){return O.isLoading=!0,K}}}),d=e=>(0,a.serialize)(e?e(0,null):null)[0],o=e=>a.INFINITE_PREFIX+d(e),c=Promise.resolve(),f=e=>(t,r,l)=>{let s,u=(0,i.useRef)(!1),{cache:o,initialSize:f=1,revalidateAll:E=!1,persistSize:g=!1,revalidateFirstPage:_=!0,revalidateOnMount:p=!1,parallel:h=!1}=l,[,,,U]=a.SWRGlobalState.get(a.cache);try{(s=d(t))&&(s=a.INFINITE_PREFIX+s)}catch(e){}let[R,C,b]=(0,a.createCacheHelper)(o,s),m=(0,i.useCallback)(()=>(0,a.isUndefined)(R()._l)?f:R()._l,[o,s,f]);(0,n.useSyncExternalStore)((0,i.useCallback)(e=>s?b(s,()=>{e()}):()=>{},[o,s]),m,m);let v=(0,i.useCallback)(()=>{let e=R()._l;return(0,a.isUndefined)(e)?f:e},[s,f]),I=(0,i.useRef)(v());(0,a.useIsomorphicLayoutEffect)(()=>{if(!u.current){u.current=!0;return}s&&C({_l:g?I.current:v()})},[s,o]);let T=p&&!u.current,V=e(s,async e=>{let i=R()._i,n=R()._r;C({_r:a.UNDEFINED});let s=[],u=v(),[d]=(0,a.createCacheHelper)(o,e),c=d().data,f=[],g=null;for(let e=0;e<u;++e){let[u,d]=(0,a.serialize)(t(e,h?null:g));if(!u)break;let[p,R]=(0,a.createCacheHelper)(o,u),C=p().data,b=E||i||(0,a.isUndefined)(C)||_&&!e&&!(0,a.isUndefined)(c)||T||c&&!(0,a.isUndefined)(c[e])&&!l.compare(c[e],C);if(r&&("function"==typeof n?n(C,d):b)){let t=async()=>{if(u in U){let e=U[u];delete U[u],C=await e}else C=await r(d);R({data:C,_k:d}),s[e]=C};h?f.push(t):await t()}else s[e]=C;h||(g=C)}return h&&await Promise.all(f.map(e=>e())),C({_i:a.UNDEFINED}),s},l),N=(0,i.useCallback)(function(e,t){let r="boolean"==typeof t?{revalidate:t}:t||{},i=!1!==r.revalidate;return s?(i&&((0,a.isUndefined)(e)?C({_i:!0,_r:r.revalidate}):C({_i:!1,_r:r.revalidate})),arguments.length?V.mutate(e,{...r,revalidate:i}):V.mutate()):c},[s,o]),L=(0,i.useCallback)(e=>{let r;if(!s)return c;let[,i]=(0,a.createCacheHelper)(o,s);if((0,a.isFunction)(e)?r=e(v()):"number"==typeof e&&(r=e),"number"!=typeof r)return c;i({_l:r}),I.current=r;let n=[],[l]=(0,a.createCacheHelper)(o,s),u=null;for(let e=0;e<r;++e){let[r]=(0,a.serialize)(t(e,u)),[i]=(0,a.createCacheHelper)(o,r),s=r?i().data:a.UNDEFINED;if((0,a.isUndefined)(s))return N(l().data);n.push(s),u=s}return N(n)},[s,o,N,v]);return{size:v(),setSize:L,mutate:N,get data(){return V.data},get error(){return V.error},get isValidating(){return V.isValidating},get isLoading(){return V.isLoading}}},E=(0,a.withMiddleware)(u,f)}}]);